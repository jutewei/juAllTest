(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{"+472":function(t,e,n){"use strict";n.r(e);var i=n("TssC"),o=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);e.default=o.a},"1/py":function(t,e){},"4YwJ":function(t,e,n){"use strict";e.__esModule=!0;var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n("mrSG"));n("O5z6");var o=n("YKMj"),r=f(n("lqyy")),s=n("Q+em"),a=f(n("/XIY")),c=f(n("Gsky")),u=n("lzrX"),l=n("9Ess");function f(t){return t&&t.__esModule?t:{default:t}}var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.user={},e.safetyInfo={},e.fetched=!1,e.thirdPartyAccountList=[],e}return i.__extends(e,t),e.prototype.beforeRouteEnter=function(t,e,n){n()},e.prototype.beforeRouteUpdate=function(t,e,n){n()},e.prototype.beforeRouteLeave=function(t,e,n){n()},e.prototype.created=function(){this.$setTitle("   "),this.setSafetyAppeal(null),this.fetchUserInfo(),this.$on("third-party-bind-phone-success",this.bindPhoneSuccessCallback)},e.prototype.mounted=function(){},Object.defineProperty(e.prototype,"showAccountCancellation",{get:function(){return!!this.$isApp||this._getAppClientConfigs("show_account_cancellation")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"passwordLevel",{get:function(){return this.safetyInfo.password_safety},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"passwordTipsText",{get:function(){var t="",e=this.passwordLevel;return 0===e?t=this.tr("texts.noPasswordSet"):1===e?t=this.tr("texts.suggestModifying"):2!==e&&3!==e||(t=this.$tr.text.modify),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"passwordLabelText",{get:function(){return this.$tr.text.loginPassword},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showLogoutButton",{get:function(){return!this._getAppClientConfigs("hide_logout_button")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phoneNumberText",{get:function(){var t=(0,l.encodePhone)(this.user.phone||"");return t||(t=this.tr("texts.unbinded")),this.fetched||(t=this._whiteSpaces),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loginProtectedTips",{get:function(){var t=this.tr("texts.unopened");return this.safetyInfo.login_protected&&(t=this.tr("texts.alreadyOpen")),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showIdentityAuth",{get:function(){return!this._isEU&&this._getAppClientConfigs("enable_identity_auth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showAccountSafetyLevel",{get:function(){return!this._isEU},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showThirdPartyAccounts",{get:function(){return this._thirdPartyAccountShow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dangerItemCount",{get:function(){return this.safetyInfo.danger_item_count||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trRiskItemsText",{get:function(){var t="",e=this.dangerItemCount,n=(this.safetyInfo.danger_item_fields||[]).indexOf("bind_external_platform")>-1,i=this._getAppClientConfigs("show_third_party_accounts");return e>0&&(n&&!i&&(e--,this.safetyInfo.danger_item_count=e),t=this.tr("texts.riskItems").replace("{n}",e.toString())),0===e&&(t=this.tr("texts.security")),this.fetched||(t=""),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loginRecordTipsText",{get:function(){return this.safetyInfo.abnormal_area_login?this.tr("texts.abnormal"):this.$tr.text.view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"idAuthStateText",{get:function(){var t=this.tr("label.unauth","safety"),e=this.user.idcard_status||0;return 1===e?t=this.tr("label.authed","safety"):2===e&&(t=this.tr("label.authing","safety")),this.fetched||(t=""),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAbnormalAreaLogin",{get:function(){return this.safetyInfo.abnormal_area_login},enumerable:!0,configurable:!0}),e.prototype.fetchUserInfo=function(){var t=this;this.thirdPartyAccountList=(0,s.getThirdPartyAccountList)();var e=this._getUserInfoFromCache(),n=this._clientInfo.uid||(e?e.id:""),i=function(){t.$toast.showLoading(t.$tr.text.loading)},o=function(){t._temp.safetyInfo&&(t.safetyInfo=t._temp.safetyInfo),t.fetched=!0};if(this._hasUserInfo())(r=this._userInfo.id)&&r.toString()===n.toString()?(this.user=this._userInfo,o()):i();else if(e){var r;(r=e.id)&&r.toString()===n.toString()?(this.user=e,o()):i()}else i();this._requestUserInfo({with_safety_info:1}).then(function(e){t.$toast.hide();var n=e.data.response;t.user=n.user,void 0!==n.safety_info&&(t.safetyInfo=n.safety_info),t.fetched=!0}).catch(function(e){e.failure?t.$toast.show(e.data.meta.msg):void 0===e.offline&&t.$toast.show(t.$tr.text.submitError)})},e.prototype.openProfilePage=function(){this._linkToModifyProfile()},e.prototype.linkToEmailOrVerifyEmail=function(){this._enableEmail&&this.user.email&&(this.setThirdPartyBinding({}),this.setTempData({accountEmail:this.user.email}),this.$router.push(this.user.email_verified?u.ROUTE_ACCOUNT_EMAIL:u.ROUTE_ACCOUNT_EMAIL_VERIFY_START))},e.prototype.linkToAccountSafetyLevel=function(){this.$router.push(u.ROUTE_ACCOUNT_SAFETY_LEVEL)},e.prototype.linkToAccountLoginProtected=function(){this.$router.push(u.ROUTE_ACCOUNT_PROTECT)},e.prototype.linkToLoginHistoryPage=function(){var t=this,e=function(){t.safetyInfo.abnormal_area_login=!1,t.$router.push(u.ROUTE_LOGIN_LOG)};this.isAbnormalAreaLogin?this.$api.safety.removeAbnormalLoginStatus().then(e).catch(e):this.$router.push(u.ROUTE_LOGIN_LOG)},e.prototype.linkToIdentityAuth=function(){var t=this.user.idcard_status||0;1===t?this.$router.push(u.ROUTE_SAFETY_IDENTITY_AUTHENTICATED):2===t?this.$router.push(u.ROUTE_SAFETY_ID_AUTH_APPLYING+"?from=account"):this._safetyDefaultIdentityAuth()},e.prototype.linkToAccountCancellation=function(){this.$router.push(u.ROUTE_CANCELLATION)},e.prototype.linkToBindOrChangePhone=function(){var t=this,e=u.ROUTE_CHANGE_PHONE_START;if(!this.user.phone&&(e=u.ROUTE_ACCOUNT_BINDING_PHONE,this.$isApp))return(0,s.openBindPhonePage)({from:"account",allow_assoc:this._getAppClientConfigs("binding_phone_allow_assoc")?1:0},function(e){t.bindPhoneSuccessCallback(e.data)}),!1;this.$router.push(e)},e.prototype.bindPhoneSuccessCallback=function(t){var e=this.tr("tips.bindingSuccess","password");void 0!==t.assoc_phone&&t.assoc_phone?(this.user.assoc_phone=t.assoc_phone,this.user.assoc_phone_cc=t.assoc_phone_cc,this.user.assoc_uid=t.assoc_uid,this.user.has_assoc_phone=!0,e=this.tr("tips.phoneAssocSuccess","binding")):void 0!==t.phone&&t.phone&&(this.user.phone=t.phone,this.user.phone_cc=t.phone_cc,this.user.has_phone=!0),this.setUserInfo(this.user),this.$toast.success(e)},e.prototype.bindOrUnbindThirdPartyAccount=function(t){1===t.binded?this.unbindThirdPartyAccount(t):2===t.binded&&this.bindThirdPartyAccount(t)},e.prototype.bindThirdPartyAccount=function(t){var e=this;this._thirdPartyBind(t,!1,function(){e.safetyInfo.danger_item_fields.indexOf("bind_external_platform")>=0&&(e.safetyInfo.danger_item_count-=1)})},e.prototype.unbindThirdPartyAccount=function(t){var e,n=this,i=[{text:this.tr("texts.unbind"),action:function(){e.close(),n._thirdPartyUnbind(t)}},{text:this.tr("texts.changeBind"),action:function(){e.close(),n._thirdPartyChangeBindConfirm(t,function(){n._thirdPartyBind(t,!0)})}}];e=this.$actionSheet.open({title:this.tr("texts.confirmText"),actions:i})},e.prototype.watchUserExternalPlatforms=function(t){this.thirdPartyAccountList=this._thirdPartyAccountListUpdateFromUserInfo(t)},e.prototype.logout=function(){this._showLogoutActionSheet()},i.__decorate([(0,o.Watch)("user.external_platforms"),i.__metadata("design:type",Function),i.__metadata("design:paramtypes",[Object]),i.__metadata("design:returntype",void 0)],e.prototype,"watchUserExternalPlatforms",null),i.__decorate([(0,o.Component)({template:n("6Pzo"),data:function(){return{ROUTE_CANCELLATION:u.ROUTE_CANCELLATION,ROUTE_ACCOUNT_SWITCH:u.ROUTE_ACCOUNT_SWITCH,ROUTE_ACCOUNT_PROTECT:u.ROUTE_ACCOUNT_PROTECT,$trPage:"account"}},components:{UserIntroView:c.default}})],e)}((0,o.Mixins)(r.default,a.default));e.default=d},"6Pzo":function(t,e){t.exports='<page class="account">\n    <title-bar :show-close="_titleBarShowCloseButton"/>\n    <page-view>\n        <page-title :title="tr(\'title\')"></page-title>\n\n        \x3c!-- 基本信息 Start --\x3e\n        <list class="basic" :header="tr(\'texts.accountInformation\')">\n            <user-intro-view :user="user"\n                             v-if="_useSDKProfileMode"\n                             :uid="user.id"\n                             @open-profile="openProfilePage">\n            </user-intro-view>\n            <list-item ficon="idcard"\n                       v-if="!_useSDKProfileMode"\n                       :title="tr(\'texts.mtid\')"\n                       :border-bottom-half="true"\n                       :text="user.id || _whiteSpaces">\n            </list-item>\n            \x3c!--\n            <list-item ficon="user"\n                       v-if="_showProfile"\n                       :title="tr(\'texts.profile\')"\n                       :text="$tr.text.modify"\n                       @click="_linkToModifyProfile"\n                       :arrow="true"\n                       :border-bottom-half="true">\n            </list-item>\n            --\x3e\n        </list>\n        \x3c!-- 基本信息 End --\x3e\n\n        \x3c!-- 帐号登录方式 Start --\x3e\n        <list class="third-party" :header="tr(\'texts.accountLoginWays\')" v-if="fetched">\n            <list-item ficon="phone"\n                       :title="tr(\'texts.phone\')"\n                       :text="phoneNumberText"\n                       @click="linkToBindOrChangePhone"\n                       :arrow="true"\n                       :border-bottom-half="true">\n            </list-item>\n            <list-item ficon="email"\n                       v-if="_enableEmail && user.email"\n                       :title="tr(\'texts.email\')"\n                       :arrow="true"\n                       @click="linkToEmailOrVerifyEmail"\n                       :text="_encodeEmail(user.email)"\n                       :border-bottom-half="true">\n                <icon v-if="!user.email_verified"\n                      @click="linkToEmailOrVerifyEmail"\n                      style="margin-left:0.05rem;"\n                      font-name="danger"\n                      font-color="danger"\n                      size="18"\n                      slot="text">\n                </icon>\n            </list-item>\n            <list-item v-if="showThirdPartyAccounts" v-for="item in _thirdPartyAccountList" :key="item.name"\n                       :icon="item.icon === \'google\' ? item.icon : \'\'"\n                       :ficon="item.icon === \'google\' ? \'\' : item.icon"\n                       :title="$tr.text[item.name]"\n                       :text="item.screen_name"\n                       text-limit="180"\n                       :arrow="item.binded === 1"\n                       :border-bottom-half="true"\n                       @offside-click="bindOrUnbindThirdPartyAccount(item)">\n                <mt-button type="primary"\n                           slot="offside"\n                           v-if="item.binded === 2"\n                           v-text="tr(\'button.binding\')" small>\n                </mt-button>\n            </list-item>\n        </list>\n        \x3c!-- 绑定第三方帐号 End --\x3e\n\n        \x3c!-- 帐号安全 Start --\x3e\n        <list class="account-safety" :header="tr(\'texts.accountSecurity\')" v-if="fetched">\n            <list-item ficon="safety-level"\n                       v-if="showAccountSafetyLevel"\n                       :title="tr(\'title\', \'safetyLevel\')"\n                       :arrow="true"\n                       @click="linkToAccountSafetyLevel"\n                       :border-bottom-half="true">\n                <span slot="text"\n                      class="text"\n                      :class="{\'text-danger\' : dangerItemCount > 0, \'text-success\' : dangerItemCount === 0}"\n                      v-text="trRiskItemsText"></span>\n            </list-item>\n            <list-item ficon="lock"\n                       v-if="user.phone || user.email"\n                       :title="passwordLabelText"\n                       @click="_linkToModifyPassword(user.has_password)"\n                       :arrow="true"\n                       :border-bottom-half="true">\n                <span slot="text"\n                      class="text"\n                      :class="{\'text-danger\' : passwordLevel < 1}"\n                      v-text="passwordTipsText"></span>\n            </list-item>\n            <list-item ficon="protect"\n                       :title="tr(\'title\', \'accountProtect\')"\n                       :text="loginProtectedTips"\n                       :arrow="true"\n                       @click="linkToAccountLoginProtected"\n                       :border-bottom-half="true">\n            </list-item>\n            <list-item ficon="history"\n                       :title="tr(\'title\', \'loginRecord\')"\n                       :arrow="true"\n                       @click="linkToLoginHistoryPage"\n                       :border-bottom-half="true">\n                <span slot="text"\n                      class="text"\n                      :class="{\'text-danger\' : isAbnormalAreaLogin }"\n                      v-text="loginRecordTipsText"></span>\n            </list-item>\n            <list-item ficon="user-verified"\n                       v-if="showIdentityAuth"\n                       @click="linkToIdentityAuth"\n                       :title="tr(\'titleOfIdAuth\', \'safety\')"\n                       :text="idAuthStateText"\n                       :arrow="true"\n                       :border-bottom-half="true">\n            </list-item>\n            <list-item ficon="close-fill"\n                       v-if="showAccountCancellation"\n                       @click="linkToAccountCancellation"\n                       :title="tr(\'title\', \'cancellationConfirm\')"\n                       :arrow="true"\n                       :border-bottom-half="true">\n            </list-item>\n        </list>\n        \x3c!-- 帐号安全 End --\x3e\n\n        <footer>\n            <mt-button border="none"\n                       square="true"\n                       :to="ROUTE_ACCOUNT_SWITCH"\n                       v-if="_enableAccountSwitch"\n                       v-text="tr(\'title\', \'accountSwitch\')">\n            </mt-button>\n            <mt-button border="none"\n                       square="true"\n                       @click="logout"\n                       v-if="showLogoutButton"\n                       v-text="tr(\'button.logout\')">\n            </mt-button>\n        </footer>\n    </page-view>\n</page>\n'},Gsky:function(t,e,n){"use strict";n.r(e);var i=n("HKcY"),o=n("+472");for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);n("LN2L");var s=n("KHd+"),a=Object(s.a)(o.default,i.a,i.b,!1,null,null,null);a.options.__file="user.intro.vue",e.default=a.exports},HKcY:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("div",{staticClass:"View user-intro",on:{click:t.viewClick}},[n("div",{staticClass:"user-avatar",on:{click:t.openProfilePage}},[n("img",{staticClass:"user-avatar-img",class:{default:t.isDefaultAvatar},attrs:{src:t.avatarImage},on:{error:t.avatarImageOnError}})]),t._v(" "),n("div",{staticClass:"user-info"},[n("p",{staticClass:"user-name",class:{loading:!t.user.screen_name},domProps:{textContent:t._s(t.user.screen_name)},on:{click:t.openProfilePage}}),t._v(" "),t.uid?n("div",{staticClass:"desc"},[n("span",{staticClass:"desc-item",domProps:{innerHTML:t._s(t.tr("texts.mtid","account")+":&nbsp;")}}),t._v(" "),n("span",{staticClass:"desc-item",domProps:{textContent:t._s(t.uid)}})]):n("div",{staticClass:"desc",on:{click:t.openSafetyLevelPage}},[n("span",{staticClass:"desc-item",domProps:{innerHTML:t._s(t.securityLevelScoreText)}}),t._v(" "),t.safetyInfo.danger_item_count>0?n("span",{staticClass:"desc-item",domProps:{innerHTML:t._s(t.beingRicksText)}}):t._e()])]),t._v(" "),t.uid?n("icon",{staticClass:"right-side",attrs:{"font-name":"arrow-right"}}):t._e()],1):t._e()},o=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o})},LN2L:function(t,e,n){"use strict";var i=n("1/py");n.n(i).a},O5z6:function(t,e){},TssC:function(t,e,n){"use strict";e.__esModule=!0;var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n("mrSG")),o=u(n("oCYn")),r=u(n("Zdk5")),s=u(n("PzH0")),a=n("rRPG"),c=n("lzrX");function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._avatarImage="",e}return i.__extends(e,t),Object.defineProperty(e.prototype,"securityLevelScoreText",{get:function(){var t=this.safetyInfo.safety_score,e=this.tr("texts.securityLevelScore","account");return void 0===t&&(t=50),e.replace("{n}",'<i class="text-danger">'+t+"</i>")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beingRicksText",{get:function(){var t=this.tr("texts.beingRisks","account");return t.replace("{n}",'<i class="text-danger">'+this.safetyInfo.danger_item_count+"</i>")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatarImage",{get:function(){return this._avatarImage=this.user.avatar?this.user.avatar+"!thumb200":a.DEFAULT_AVATAR,this._avatarImage},set:function(t){this._avatarImage=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDefaultAvatar",{get:function(){return this.avatarImage===a.DEFAULT_AVATAR},enumerable:!0,configurable:!0}),e.prototype.viewClick=function(){this.uid&&this.openProfilePage()},e.prototype.openProfilePage=function(){this.$emit("open-profile")},e.prototype.avatarImageOnError=function(){var t=this.avatarImage;t=-1!==t.indexOf("!thumb200")?t.replace(/!thumb200/g,""):a.DEFAULT_AVATAR,this.avatarImage=t},e.prototype.openSafetyLevelPage=function(){this.$router.push(c.ROUTE_ACCOUNT_SAFETY_LEVEL)},i.__decorate([(0,r.default)({name:"user-intro-view",data:function(){return{_avatarImage:"",ROUTE_ACCOUNT_SAFETY_LEVEL:c.ROUTE_ACCOUNT_SAFETY_LEVEL}},components:{Icon:s.default},props:{show:{type:Boolean,default:!0},profileUrl:{type:String,default:c.ROUTE_PROFILE},user:{type:Object,default:function(){return{screen_name:"",avatar:""}}},uid:{type:String|Number,default:""},safetyInfo:{type:Object,default:function(){return{safety_score:0,danger_item_count:0}}}}})],e)}(o.default);e.default=l}}]);