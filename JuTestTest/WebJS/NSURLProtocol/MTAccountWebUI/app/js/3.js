(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"/6d3":function(t,e,a){"use strict";a.r(e);var i=a("cGX2"),n=a("1Po0");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("Yt/B");var s=a("KHd+"),r=Object(s.a)(n.default,i.a,i.b,!1,null,null,null);r.options.__file="date.picker.vue",e.default=r.exports},"0Ivh":function(t,e,a){"use strict";e.__esModule=!0;var i=u(a("4d7F")),n=u(a("b0Xh")),o=u(a("MgzW")),s=u(a("FIxc")),r=u(a("0iME"));function u(t){return t&&t.__esModule?t:{default:t}}a("5HtE"),window.EXIF=n.default;var c={http:{},rotate:0,crop:!1,quality:91,timeout:5e4,imageWidth:360,imageTypes:["jpg","jpeg","png"],dataType:"json",fetchTokenUrl:r.default.uploadToken,uploadToken:{token:"",key:"",upload_host:""},uploadTokenBackup:{}},l=function(){function t(t){void 0===t&&(t={}),this.options=c,this.defaultOptions=c,this.options=(0,o.default)({},this.defaultOptions,t);var e=t.http;return this.http=e,this}return t.prototype.getUploadToken=function(t){var e=this,a=this.options;return s.default.formData()||(t.need_callback=1,"devaccount.meitu.com"===location.hostname&&(t.need_callback=2)),"https:"===location.protocol&&(t.is_https=1),new i.default(function(i,n){a.uploadToken&&a.uploadToken.key?i():e.http.request({method:"get",params:t,url:a.fetchTokenUrl,dataType:a.dataType}).then(function(t){var e=t.data;a.uploadTokenBackup=e.response.backup,a.uploadToken=e.response.main,i(e)}).catch(n)})},t.prototype._canvasResize=function(t,e){window.canvasResize(t,{width:this.options.imageWidth,crop:this.options.crop,quality:this.options.quality,rotate:this.options.rotate,callback:function(t){e(t)}})},t.prototype._formUpload=function(t,e,a,i){var n=this,o=this.options.uploadToken?this.options.uploadToken.token:"",r=this.options.uploadToken?this.options.uploadToken.key:"",u=this.options.uploadToken?this.options.uploadToken.upload_host:"";if(!s.default.formData())return"function"==typeof i&&i({token:o,key:r,host:u},this._uploadCallback),!1;var c=new FormData;c.append("token",o),c.append("key",r),c.append("file",t),this.http.post(u,c,{useAjax:!0,isUpload:!0,timeout:this.options.timeout,notCommonParams:!0,notAccessToken:!0,notUnloginToken:!0,cache:!1,processData:!1,contentType:!1,headers:{Authorization:"UpToken "+o}}).then(function(t){n._uploadCallback(t.data,e)}).catch(a)},t.prototype.formUpload=function(t,e,a){var n,s=this;void 0===e&&(e={}),void 0!==t.target&&(t=t.target),t.files&&(t=t.files[0]);var r=navigator.userAgent,u=r.substr(r.indexOf("Android")+8,3);n=(n=t.value?t.value.split("."):t.name.split("."))[n.length-1].toLowerCase();var c=(0,o.default)({ext:n,type:"avatar"},e);return new i.default(function(e,i){s.getUploadToken(c).then(function(){(parseInt(u,10)>4.3||r.indexOf("iPhone")>-1||r.indexOf("iPad")>-1)&&"undefined"!=typeof FileReader?s._canvasResize(t,function(t){s._base64Upload(t,e,i)}):s._formUpload(t,e,i,a)}).catch(i)})},t.prototype._base64Upload=function(t,e,a){var i=this;t=(t=t.replace("data:image/jpeg;base64,","").replace("data:image/png;base64,","")).replace("data:image/jpg;base64,","");var n=this.options.uploadToken,o=n?n.token:"",s=n?n.key:"",r=n?n.upload_host+"/putb64/-1/key/"+s:"";this.http.ajaxRequest({url:r,method:"post",data:t,useAjax:!0,isUpload:!0,timeout:this.options.timeout,notCommonParams:!0,notAccessToken:!0,notUnloginToken:!0,headers:{"Content-Type":"application/octet-stream",Authorization:"UpToken "+o}},function(t){i._uploadCallback(t.data,e)},a)},t.prototype.base64Upload=function(t,e){var a=this,n=(0,o.default)({ext:"jpg",type:"avatar"},e);return new i.default(function(e,i){a.getUploadToken(n).then(function(){a._base64Upload(t,e,i)}).catch(i)})},t.prototype._uploadCallback=function(t,e){var a=this.options.uploadToken||{};t.img=a.url||"",void 0!==a.url_with_token&&(t.img_with_token=a.url_with_token),e(t),this.options.uploadToken={},this.options.uploadTokenBackup={}},t}();e.default=l},"1Po0":function(t,e,a){"use strict";a.r(e);var i=a("wX2h"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e.default=n.a},"6dEi":function(t,e,a){"use strict";a.r(e);var i=a("ewbU"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e.default=n.a},DYo6:function(t,e){},JgHc:function(t,e){t.exports="data:image/png;base64,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"},"Lno+":function(t,e,a){"use strict";e.__esModule=!0;var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}(a("mrSG")),n=u(a("MgzW")),o=a("YKMj"),s=u(a("0Ivh")),r=a("Q+em");function u(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype._uploadChooseImage=function(t,e,a){var i=this;void 0===t&&(t=function(){}),void 0===e&&(e={}),void 0===a&&(a={}),this.$actionSheet.open((0,n.default)({title:this.tr("texts.setAvatar","profile"),actions:[{text:this.tr("texts.openCamera","profile"),id:"camera"},{text:this.tr("texts.openAlbum","profile"),id:"photo"}],select:function(a){i._uploadChooseImageCommand(""+a.id,e,t),i.$actionSheet.close()}},a))},e.prototype._uploadRequest=function(t,e,a){void 0===e&&(e={}),void 0===a&&(a={}),a=(0,n.default)({http:this.$http,unsupported:function(){}},a);var i=new s.default(a);return this.$isWeb||(0,r.isAppBrowserDebug)()?i.formUpload(t,e,a.unsupported):i.base64Upload(t,e)},e.prototype._uploadChooseImageCommand=function(t,e,a){void 0===e&&(e={}),void 0===a&&(a=function(){}),this._uploadGetCameraDataEventListener(a),this.$command("camera"===t?"openCamera":"openPhotoLibrary",{data:e})},e.prototype._uploadGetCameraDataEventListener=function(t,e){void 0===t&&(t=function(t){}),void 0===e&&(e=!0);var a=this,i=a.$tr.text,n=window;n.removeEventListener("_getCameraData_",n.getCameraDataHandle||function(){}),n.getCameraDataHandle=function(n){if(!e)return t(n),!1;a.$command("getImageBase64",{pic:n.data[0].img},function(e){if(110===e.data.code)return a.$toast.show(i.imageBase64Error),!1;t(e.data.img)})},n.addEventListener("_getCameraData_",n.getCameraDataHandle)},i.__decorate([o.Component],e)}((0,o.Mixins)());e.default=c},NWM6:function(t,e,a){"use strict";var i=a("WttR");a.n(i).a},WttR:function(t,e){},"XFg+":function(t,e,a){"use strict";a.r(e);var i=a("uThC"),n=a("6dEi");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("NWM6");var s=a("KHd+"),r=Object(s.a)(n.default,i.a,i.b,!1,null,null,null);r.options.__file="profile.vue",e.default=r.exports},"Yt/B":function(t,e,a){"use strict";var i=a("DYo6");a.n(i).a},cGX2:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{duration:{enter:350,leave:300}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showPicker,expression:"showPicker"}],staticClass:"Component date-picker"},[a("div",{staticClass:"date-picker-mask",on:{click:t.hideDatePicker}}),t._v(" "),a("transition",{attrs:{name:"slide-up"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showPicker,expression:"showPicker"}],staticClass:"date-picker-main"},[a("div",{staticClass:"date-picker-header clearfix"},[a("span",{staticClass:"date-picker-select"},[a("span",{on:{click:function(e){t.changeDateType("year")}}},[t._v(t._s(t.selectDay.y)+" 年")])]),t._v(" "),a("span",{staticClass:"date-picker-select"},[a("span",{on:{click:function(e){t.changeDateType("month")}}},[t._v(t._s(t.selectDay.M)+" 月")])])]),t._v(" "),a("div",{staticClass:"date-picker-databox"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"day"===t.showDateType,expression:"showDateType === 'day'"}],staticClass:"date-picker-table"},[a("ul",{staticClass:"date-picker-thead clearfix"},t._l(["日","一","二","三","四","五","六"],function(e,i){return a("li",{key:i,staticClass:"date-picker-td"},[t._v(t._s(e))])})),t._v(" "),a("ul",{staticClass:"date-picker-tbody clearfix"},[t._l(t.prevMonth,function(e,i){return a("li",{key:"p"+i,staticClass:"date-picker-td disabled"},[t._v(t._s(e))])}),t._v(" "),t._l(t.nowMonth,function(e,i){return a("li",{key:i,staticClass:"date-picker-td",class:{active:+t.selectDay.d===e,disabled:t.nowDate.y===t.selectDay.y&&t.nowDate.M===t.selectDay.M&&e>t.nowDate.d},on:{click:function(a){t.select(e,"d")}}},[t._v(t._s(e))])}),t._v(" "),t._l(t.nextMonth,function(e,i){return a("li",{key:"n"+i,staticClass:"date-picker-td disabled"},[t._v(t._s(e))])})],2),t._v(" "),a("ul",{staticClass:"date-picker-tfoot clearfix"},[a("li",{staticClass:"date-picker-td"},[a("span",{on:{click:function(e){t.selectNow("day")}}},[t._v("今天")])]),t._v(" "),a("li",{staticClass:"date-picker-td"},[a("span",{on:{click:t.hideDatePicker}},[t._v("取消")])]),t._v(" "),a("li",{staticClass:"date-picker-td"},[a("span",{on:{click:t.selectConfirm}},[t._v("确定")])])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"month"===t.showDateType,expression:"showDateType === 'month'"}],staticClass:"date-picker-list"},[a("ul",{staticClass:"date-picker-list__scroll"},t._l(12,function(e){return a("li",{key:"mth"+e,staticClass:"date-picker-item"},[a("span",{class:{active:+t.selectDay.M===e,disabled:t.nowDate.M<e&&t.selectDay.y===t.nowDate.y},on:{click:function(a){t.select(e,"M")}}},[t._v(t._s(e)+" 月")])])})),t._v(" "),a("div",{staticClass:"date-picker-foot"},[a("span",{on:{click:function(e){t.selectNow("M")}}},[t._v("这个月")]),t._v(" "),a("span",{on:{click:function(e){t.changeDateType("day",!0)}}},[t._v("取消")])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"year"===t.showDateType,expression:"showDateType === 'year'"}],staticClass:"date-picker-list"},[a("ul",{staticClass:"date-picker-list__scroll"},t._l(t.yearNum,function(e){return a("li",{key:"mty"+e,staticClass:"date-picker-item"},[a("span",{class:{active:+t.selectDay.y===1969+e},on:{click:function(a){t.select(1969+e,"y")}}},[t._v(t._s(1969+e)+" 年")])])})),t._v(" "),a("div",{staticClass:"date-picker-foot"},[a("span",{on:{click:function(e){t.selectNow("y")}}},[t._v("今年")]),t._v(" "),a("span",{on:{click:function(e){t.changeDateType("day")}}},[t._v("取消")])])])])])])],1)])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},ewbU:function(t,e,a){"use strict";e.__esModule=!0;var i=g(a("EJiy")),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}(a("mrSG")),o=a("YKMj"),s=g(a("PzH0")),r=g(a("J+9/")),u=g(a("kJsp")),c=g(a("Lno+")),l=g(a("lqyy")),p=a("KEQF"),d=a("9Ess"),f=a("uOKE"),h=a("lzrX"),v=a("X8Hg"),m=a("9Ess"),y=g(a("EeRk"));function g(t){return t&&t.__esModule?t:{default:t}}var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fetched=!1,e.defaultAvatar=a("JgHc"),e.avatar=e.defaultAvatar,e.avatarThumb="!thumb200",e.uploading=!1,e.submitting=!1,e.showDatepiker=!1,e.isModify=!0,e.requireFields=[],e.userInfo={},e.descMaxLength=140,e.useExternalAvatar=!1,e.registerResponse=null,e.type="",e}return n.__extends(e,t),e.prototype.created=function(){var t=this;this.type=this.queries.type,this._isNotProfileModifyUrl?(this.$toast.showLoading(this.$tr.text.loading),this.isModify=!1,this.$accountCommand("getRegisterResponse",{},function(e){t.registerResponse=e.data,e.data.required_fields&&(t.requireFields=e.data.required_fields),e.data.user&&(t.userInfo=e.data.user);var a=e.data.suggested_info;if(a)for(var i in a)a.hasOwnProperty(i)&&a[i]&&("avatar"===i?(t.avatar=a[i],t.useExternalAvatar=!0):t.userInfo[i]=a[i]);t.$toast.hide(),t.fetched=!0})):((0,d.isEmptyObject)(this._userInfo)?this.$toast.showLoading(this.$tr.text.loading):(this.userInfo=this._userInfo,this.avatar=this.getAvatar(),this.fetched=!0),this.getUserInfo(function(){t.fetched=!0}))},Object.defineProperty(e.prototype,"queries",{get:function(){return this.$route.query||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isNotProfileModifyUrl",{get:function(){var t=this.$route.path;return t.indexOf(h.ROUTE_REGISTER_PROFILE)>=0||t.indexOf(h.ROUTE_BINDING_PROFILE)>=0||t.indexOf(h.ROUTE_LOGIN_PROFILE)>=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"genderName",{get:function(){var t=this.userInfo.gender;return this._userGenderName(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._isNotProfileModifyUrl?this.tr("title"):this.tr("title2")},enumerable:!0,configurable:!0}),e.prototype.getAvatar=function(){return this.userInfo.avatar?this.userInfo.avatar+this.avatarThumb:this.userInfo.avatar||this.defaultAvatar},e.prototype.getUserInfo=function(t){var e=this;this.$api.user.info().then(function(a){var i=a.data.response;e.userInfo=i.user,e.avatar=e.getAvatar(),e.requireFields=i.required_fields,e.$toast.hide(),e.setUserInfo(e.userInfo),"function"==typeof t&&t(i)})},e.prototype.chooseImage=function(){var t=this;t._uploadChooseImage(function(e){t.$toast.showLoading(),t._uploadRequest(e).then(function(e){t.$toast.hide(),t.avatar=e.img,t.$toast.show(t.tr("tips.uploadSuccess"))}).catch(function(e){if(t.$toast.hide(),e.failure){var a=e.data||{};t.$toast.show(a.meta.msg)}else e.offline?t.$toast.show(t.$tr.text.networkDisconnected):t.$toast.show(t.$tr.text.submitError)})})},e.prototype._userGenderName=function(t){var e="";return t&&(e="m"===t?this.tr("texts.genderMale"):this.tr("texts.genderFemale")),e},e.prototype.selectGender=function(){var t=this,e=this,a=e._userGenderName("m"),i=e._userGenderName("f"),n="m"===this.userInfo.gender,o="f"===this.userInfo.gender;e.$actionSheet.open({actions:[{text:a,id:"m",selected:n},{text:i,id:"f",selected:o}],select:function(a){t.userInfo.gender=a.id,e.$actionSheet.close()}})},e.prototype.selectDate=function(t){var e=this;if(this.$isApp)return this.$accountCommand("SelectDate",{date:this.userInfo.birthday},function(t){e.userInfo.birthday=t.data.date}),!1;this.showDatepiker&&(this.userInfo.birthday=t.F),this.showDatepiker=!this.showDatepiker},e.prototype.selectRegion=function(){var t=this;this.$accountCommand("SelectRegion",{country:this.userInfo.country,province:this.userInfo.province,city:this.userInfo.city},function(e){var a=e.data;t.userInfo.country=a.country,t.userInfo.province=a.province,t.userInfo.city=a.city,t.userInfo.country_name=a.country_str,t.userInfo.province_name=a.province_str,t.userInfo.city_name=a.city_str,t.userInfo.location=t._makeUserLocation(t.userInfo)})},e.prototype.isRequireField=function(t){return this.requireFields.indexOf(t)>=0},e.prototype.isOverOfCurrentDate=function(t){var e=(t=new Date(t)).getFullYear(),a=t.getMonth()+1,i=t.getDate(),n=new Date,o=n.getFullYear(),s=n.getMonth()+1,r=n.getDate();return e>o||e>=o&&a>s||e>=o&&a>=s&&i>r},e.prototype.profileUpdate=function(){if(this.submitting)return!1;if(this.isRequireField("avatar")&&(""===this.avatar.trim()||this.avatar===this.defaultAvatar))return this.$toast.show(this.tr("tips.avatarEmpty")),!1;if(this.isRequireField("screen_name")||""!==this.userInfo.screen_name){if(""===this.userInfo.screen_name.trim())return this.$toast.show(this.tr("tips.nickNameEmpty")),!1;if((0,m.strlenWeibo)(this.userInfo.screen_name)>10||/[\s@#:：]+/g.test(this.userInfo.screen_name))return this.$toast.show(this.tr("tips.nickNameError")),!1}if(this.isRequireField("gender")&&(""===this.userInfo.gender.trim()||"0"===this.userInfo.gender.trim()))return this.$toast.show(this.tr("tips.genderEmpty")),!1;if(this.isRequireField("birthday")||""!==this.birthday){if(""===this.userInfo.birthday.trim())return this.$toast.show(this.tr("tips.birthdayEmpty")),!1;if(this.isOverOfCurrentDate(this.userInfo.birthday))return this.$toast.show(this.tr("tips.overOfCurrentDate")),!1}if(this.isRequireField("country")&&""===(this.userInfo.country+"").trim())return this.$toast.show(this.tr("tips.locationEmpty")),!1;if(this.isRequireField("description")||""!==this.userInfo.description){if(""===this.userInfo.description.trim())return this.$toast.show(this.tr("tips.descriptionEmpty")),!1;if((0,m.strlenWeibo)(this.userInfo.description)>this.descMaxLength)return this.$toast.show(this.tr("tips.descriptionMaxLength")),!1}this.isModify?this.$dialog.confirm({title:this.tr("tips.updateProfile"),content:'<p class="text-left">'+this.tr("tips.updateProfile2")+"</p>",buttons:[{text:this.$tr.text.enter,type:"primary",click:this.submitUserInfoRequest},{text:this.$tr.text.cancel}]}):this.submitUserInfoRequest()},e.prototype.submitUserInfoRequest=function(){var t=this,e=this.registerResponse,a=this._getAppClientConfigs("module_client_secret"),o={screen_name:this.userInfo.screen_name,gender:this.userInfo.gender,avatar:this.avatar===this.defaultAvatar?"":this.avatar.replace(this.avatarThumb,""),avatar_url_sig:this.userInfo.avatar_url_sig,birthday:this.userInfo.birthday,country:this.userInfo.country,province:this.userInfo.province,city:this.userInfo.city,description:this.userInfo.description};this.useExternalAvatar&&!this.userInfo.avatar&&(o.use_external_avatar=1),e&&e.update_token&&(o.update_token=e.update_token),a&&(o.module_client_secret=a),this.isModify&&(o.from_account_page=!0),this.submitting=!0,this.$toast.showLoading(),this.$http.post(this.$api.$paths.profileUpdate,o).then(function(a){var o=a.data.response,s=t.isModify?t.tr("tips.submitSuccess"):t.tr("tips.submitSuccessOfRegister");if(t.userInfo=o.user,t.avatar=t.getAvatar(),t.submitting=!1,t.isModify)t._useSDKProfileMode&&t.getUserInfo(function(e){if(t.$toast.show(s),t.$isApp){var a=(window.APP||{}).loginHistory,i=e.user;t.userInfo=i,a&&a.length>0&&a.forEach(function(t){if(String(t.uid)===String(i.id))for(var e in t)"platform"!==e&&"uid"!==e&&t[e]!==i[e]&&(t[e]=i[e])}),i.avatar&&(i.avatar_https=i.avatar.replace("http://","https://")),i.location=t._makeUserLocation(i),t._updateClientSwitchAccountList({user:i}),t.$accountCommand("Notice",{code:f.NOTICE_USER_INFO_UPDATE,data:i})}});else{var r="",u=!1,c=t.$route.path;if("object"===(0,i.default)(e.user)){var l=e.user.external_platforms;for(var d in l)l.hasOwnProperty(d)&&l[d]&&(r=d)}(c.indexOf("/register/profile")>=0||c.indexOf("/binding/profile")>=0)&&(u=!0,t.getTempData.forceBindPhone&&t.setTempData({forceBindPhone:!1})),e&&void 0!==e.register_process&&(u=!0),(t.getTempData.loginEmail||t.getTempData.registerEmail||!e.user.phone&&e.user.email)&&(r="email"),e.user.phone&&(r="phone"),void 0!==o.refresh_token&&t.$localStorage.set("refresh.token",o.user.id),void 0!==o.user&&t.$localStorage.set("lasted.uid",o.user.id),(0,p.commandLoginConnect)(n.__assign({},o,{platform:r}),u?2:1),t.$toast.show(s)}}).catch(function(e){if(t.submitting=!1,e.failure){var a=e.data||{};t.$toast.show(a.meta.msg)}else t.$toast.show(t.$tr.text.submitError)})},e.prototype.avatarImageError=function(){this.avatar=this.avatar.indexOf(this.avatarThumb)>=0?this.avatar.replace(this.avatarThumb,""):this.defaultAvatar},e.prototype.avatarImageLoaded=function(){this.uploading=!1},n.__decorate([(0,o.Component)({components:{List:y.default,InputGroup:v.InputGroup,MtInput:v.MtInput,MtTextArea:v.MtTextArea,Icon:s.default,DatePicker:u.default,MtButton:r.default},data:function(){return{$trPage:"profile"}}})],e)}((0,o.Mixins)(c.default,l.default));e.default=_},kJsp:function(t,e,a){"use strict";e.__esModule=!0;var i,n=(i=a("/6d3"))&&i.__esModule?i:{default:i};e.default=n.default},uThC:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",{staticClass:"page-profile"},[a("title-bar"),t._v(" "),t.fetched?a("page-view",{attrs:{padding:""}},[a("page-title",{attrs:{title:t.title}}),t._v(" "),a("div",{staticClass:"page-profile-form"},[t.userInfo.id?a("input-group",[a("span",{staticClass:"label"},[t._v("UID")]),t._v(" "),a("mt-input",{attrs:{readonly:""},model:{value:t.userInfo.id,callback:function(e){t.$set(t.userInfo,"id",e)},expression:"userInfo.id"}})],1):t._e(),t._v(" "),a("input-group",{attrs:{arrow:"true"}},[a("span",{staticClass:"label label-avatar",domProps:{textContent:t._s(t.tr("label.avatar"))}}),t._v(" "),a("div",{staticClass:"avatar-box"},[a("img",{staticClass:"avatar",attrs:{src:t.avatar,alt:"avatar"},on:{error:t.avatarImageError,load:t.avatarImageLoaded,click:t.chooseImage}})])]),t._v(" "),a("input-group",[a("span",{staticClass:"label",domProps:{textContent:t._s(t.tr("label.nickName"))}}),t._v(" "),a("mt-input",{attrs:{placeholder:t.tr("placeholder.nickName"),clear:""},model:{value:t.userInfo.screen_name,callback:function(e){t.$set(t.userInfo,"screen_name",e)},expression:"userInfo.screen_name"}})],1),t._v(" "),a("input-group",[a("span",{staticClass:"label",domProps:{textContent:t._s(t.tr("label.gender"))}}),t._v(" "),a("mt-input",{attrs:{placeholder:t.tr("placeholder.select"),readonly:"",value:t.genderName},on:{click:function(e){return e.stopPropagation(),t.selectGender(e)}}}),t._v(" "),a("icon",{attrs:{"font-name":"arrow-right"},on:{click:function(e){return e.stopPropagation(),t.selectGender(e)}}})],1),t._v(" "),a("input-group",{staticClass:"birthday"},[a("span",{staticClass:"label",domProps:{textContent:t._s(t.tr("label.birthday"))}}),t._v(" "),a("mt-input",{attrs:{placeholder:t.tr("placeholder.select"),readonly:""},on:{click:function(e){return e.stopPropagation(),t.selectDate(e)}},model:{value:t.userInfo.birthday,callback:function(e){t.$set(t.userInfo,"birthday",e)},expression:"userInfo.birthday"}}),t._v(" "),a("icon",{attrs:{"font-name":"arrow-right"},on:{click:function(e){return e.stopPropagation(),t.selectDate(e)}}})],1),t._v(" "),a("input-group",[a("span",{staticClass:"label",domProps:{textContent:t._s(t.tr("label.location"))}}),t._v(" "),a("div",{staticClass:"Component input input-text",on:{click:function(e){return e.stopPropagation(),t.selectRegion(e)}}},[t.userInfo.location?a("span",{domProps:{textContent:t._s(t.userInfo.location)}}):a("span",{staticClass:"placeholder",domProps:{textContent:t._s(t.tr("placeholder.select"))}})]),t._v(" "),a("icon",{attrs:{"font-name":"arrow-right"},on:{click:function(e){return e.stopPropagation(),t.selectRegion(e)}}})],1),t._v(" "),a("input-group",[a("span",{staticClass:"label",domProps:{textContent:t._s(t.tr("label.description"))}}),t._v(" "),a("mt-text-area",{attrs:{placeholder:"留下一句话告诉我你有多美","max-length":t.descMaxLength},model:{value:t.userInfo.description,callback:function(e){t.$set(t.userInfo,"description",e)},expression:"userInfo.description"}})],1)],1),t._v(" "),a("div",{staticClass:"page-profile-footer"},[t.isModify&&"third_party_login_callback"!==t.type?a("mt-button",{attrs:{type:"primary"},domProps:{textContent:t._s(t.tr("button.submit"))},on:{click:t.profileUpdate}}):a("mt-button",{attrs:{type:"primary"},domProps:{textContent:t._s(t.tr("button.submitOfRegister"))},on:{click:t.profileUpdate}})],1),t._v(" "),a("date-picker",{attrs:{show:t.showDatepiker},on:{selector:t.selectDate}})],1):t._e()],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},wX2h:function(t,e,a){"use strict";e.__esModule=!0;var i,n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}(a("mrSG")),o=a("YKMj"),s=(i=a("PzH0"))&&i.__esModule?i:{default:i},r=function(t){return t>=10?t:"0"+t},u=function(t){if(void 0===t&&(t=(new Date).getTime()),isNaN(t)&&t.length>=8){var e=t.replace(/年|月|\//g,"-").replace(/日/g,"").split(/-|\s|:/g);e.length>=3&&(t=new Date(e[0],e[1]-1||0,e[2]||1,e[3]||null,e[4]||null,e[5]||null).getTime())}t=new Date(parseInt(t.toString().length<11?1e3*t:t,10));var a=r,i={y:t.getFullYear(),M:t.getMonth(),d:a(t.getDate()),h:a(t.getHours()),m:a(t.getMinutes()),s:a(t.getSeconds()),time:t.getTime(),week:t.getDay()};return i.nowM=new Date(i.y,i.M,1),i.firstWeek=i.nowM.getDay(),i.days=new Date(i.y,i.M+1,0).getDate(),i.prevDays=new Date(i.y,i.M,0).getDate(),i.M=a(i.M+1),i.F=i.y+"-"+i.M+"-"+i.d,i},c=u(),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showPicker=!0,e.showDateType="day",e.nowDate=c,e.selectDay=c,e}return n.__extends(e,t),e.prototype.changeDateType=function(t,e){this.showDateType=t,e&&this.select(this.selectDay.M,"M")},e.prototype.selectNow=function(t){"day"===t?this.selectDay=_.clone(this.nowDate):this.select(this.nowDate[t],t)},e.prototype.select=function(t,e){var a=event,i=(this.selectDay[e].toString(),this.nowDate),n=this.selectDay;if(a&&a.currentTarget&&/disabled/.test(a.currentTarget.className))return!1;n[e]=t,"y"===e&&(this.changeDateType("month"),n.y===i.y&&n.M>i.M&&(n.M=i.M,n.d>i.d&&(n.d=i.d))),"M"===e&&(n.y===i.y&&n.M===i.M&&n.d>i.d?this.selectDay=u():this.selectDay=u(n.y+"-"+n.M+"-"+n.d),this.changeDateType("day"))},e.prototype.selectConfirm=function(t){t=u(+new Date(this.selectDay.y,this.selectDay.M-1,this.selectDay.d)),this.selectDay=t,this.selectedCfm(t)},e.prototype.changeShow=function(t){"string"==typeof t&&"false"===t.trim()?(this.showPicker=!1,this.initSelectDay()):this.showPicker=!!t},e.prototype.selectedCfm=function(t){this.showPicker=!1},e.prototype.hideDatePicker=function(){this.showPicker=!1},e.prototype.initSelectDay=function(){this.selectDay=u(this.date)},Object.defineProperty(e.prototype,"yearNum",{get:function(){return this.endYear-1969},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nowMonth",{get:function(){var t,e=this.selectDay.days,a=1;for(t=[];a<e+1;)t.push(a),a++;return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prevMonth",{get:function(){var t,e=this.selectDay.prevDays,a=this.selectDay.firstWeek,i=0;for(t=[];i<a;)t.unshift(e-i),i++;return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextMonth",{get:function(){for(var t=this.selectDay.firstWeek,e=42-this.selectDay.days-t,a=[],i=0;i<e;)i++,a.push(i);return a},enumerable:!0,configurable:!0}),n.__decorate([(0,o.Watch)("show",{immediate:!0}),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object]),n.__metadata("design:returntype",void 0)],e.prototype,"changeShow",null),n.__decorate([(0,o.Emit)("selector"),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object]),n.__metadata("design:returntype",void 0)],e.prototype,"selectedCfm",null),n.__decorate([(0,o.Emit)("close"),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[]),n.__metadata("design:returntype",void 0)],e.prototype,"hideDatePicker",null),n.__decorate([(0,o.Watch)("date",{immediate:!0}),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[]),n.__metadata("design:returntype",void 0)],e.prototype,"initSelectDay",null),n.__decorate([(0,o.Component)({components:{Icon:s.default},props:{endYear:{type:Number|String,default:c.y},show:Boolean|String,date:Number|String}})],e)}(o.Vue);e.default=l}}]);